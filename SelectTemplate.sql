select distinct top column1,
column2,
column3
from table1
where <search_condition>
group by groupcolumn
having <agg_condition>
order by columnX ASC/DESC